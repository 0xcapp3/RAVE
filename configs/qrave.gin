include "configs/xrave.gin"

num_quantizers = 4
ratios = [4, 2, 2, 2]
latent_size = 512

# ENCODER
ResidualVQ:
    dim = %latent_size
    num_quantizers = %num_quantizers
    codebook_size = 1024
    channel_last = False

discrete/Encoder.n_out = 1

DiscreteEncoder:
    encoder = @discrete/Encoder
    beta = .1
    latent_size = %latent_size
    num_quantizers = %num_quantizers

# RAVE
RAVE.encoder = @DiscreteEncoder  

